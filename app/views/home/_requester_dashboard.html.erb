<div class="panel"> 

<h4> Hi, <%="#{current_user.andrew_id}"%>!  </h4>
<br /> 

<button>Apply for a new key<% link_to new_user_key_path %></button>

<p> My Existing Keys: </p>
<% if @confirmed_keys.size > 0 %>
<table>
  <tr>
    <th>Key</th>
    <th>Value</th>
    <th>Expiry Date</th>
  </tr>
<% @confirmed_keys.each do |key| %>
  <tr>
    <td><%= link_to key.name, user_key_path(key) %></td>
    <td><%= key.value %></td>
    <td><%= key.time_expired ? key.time_expired.to_formatted_s(:pretty) : "N/A" %></td>
  </tr>
<% end %>
</table>
<% else %>
None
<% end %>

<p> Incomplete Applications: </p>
<% if @in_progress.size > 0 %>
<table>
  <tr>
    <th>Key</th>
    <th>Date Started</th>
  </tr>
<% @in_progress.each do |key| %>
  <tr>
    <td><%= link_to key.name, user_key_path(key) %></td>
    <td><%= key.created_at.to_formatted_s(:pretty) %></td>
  </tr>
<% end %>
</table>
<% else %>
None
<% end %>

<p> Applications Awaiting Administrator Review: </p>
<% if @awaiting_admin_review.size > 0 %>
<table>
  <tr>
    <th>Key</th>
    <th>Date Started</th>
  </tr>
<% @awaiting_admin_review.each do |key| %>
  <tr>
    <td><%= link_to key.name, user_key_path(key) %></td>
    <td><%= key.created_at.to_formatted_s(:pretty) %></td>
  </tr>
<% end %>
</table>
<% else %>
None
<% end %>


<p> My Expired Keys: </p>
<% if @expired_keys.size > 0 %>
<table>
  <tr>
    <th>Key</th>
    <th>Expiry Date</th>
  </tr>
<% @expired_keys.each do |key| %>
  <tr>
    <td><%= link_to key.name, user_key_path(key) %></td> 
    <td><%= key.time_expired ? key.time_expired.to_formatted_s(:pretty) : "N/A" %></td>
  </tr>
<% end %>
</table>
<% else %>
None
<% end %>

</div>